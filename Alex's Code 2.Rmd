---
title: "Alex's Code"
author: "Alex Mix"
date: "12/5/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggcorrplot)
library(tidyverse)
library(GGally)
library(dplyr)
library(fpc)
library(cluster)

```


```{r}
coaster_data <- read.csv("FileName.csv")
#Reorder Rating variable
coaster_data <- coaster_data %>% mutate(Rating = recode_factor(Rating, '10 (Superior)'="10.0 (Superior)"))

order <- c("2.0 (Horrible)", "3.0 (Bad)", "3.5 (Bad)", "4.0 (Below Average)", "5.0 (Average)", "5.5 (Average)", "6.0 (Above Average)", "6.5 (Above Average)", "7.0 (Good)", "7.5 (Good)", "8.0 (Great)", "8.5 (Great)", "9.0 (Excellent)", "9.5 (Excellent)", "10.0 (Superior)")

coaster_data$Rating <- factor(coaster_data$Rating, levels = order)

coaster_data<-coaster_data %>% separate(Rating, c("Score.2","Cat_score"), " ")
coaster_data$Score.2 <- as.double(coaster_data$Score.2)
```


```{r}
# data exploration
pairs <- pairs(coaster_data[,c(5,6,7,8,9,10,11,14)])
#pairs

corr_matrix <- model.matrix(~0+., data=coaster_data[,c(14,8,9,10,11)]) %>% 
  cor(use="pairwise.complete.obs") %>% 
  ggcorrplot(show.diag = F, type="lower", lab=TRUE, lab_size=2, title = "Correlation Matrix")
#corr_matrix

#the plot zone
ggplot( data= coaster_data, aes(x=height.x, y=speed.x, color=Rating)) + geom_point()
ggplot( data= coaster_data, aes(x=length.x, y=speed.x, color=Rating)) + geom_point()
ggplot( data= coaster_data, aes(x=num_inversions, y=speed.x, color=score)) + geom_point()
ggplot( data= coaster_data, aes(x=score, y=speed.x, color=material_type)) + geom_point()
ggplot( data= coaster_data, aes(x=height.x, y=speed.x, color=num_inversions)) + geom_point()

biggg <- ggpairs(coaster_data[,c(8,9,10,11,14)])
#biggg
```

```{r}
#kmeans clustering
coasters_scaled <- scale(coaster_data[,c(4,9,10,11,12,15)])
coasters.k2 <- kmeans(coasters_scaled, centers=2, iter.max = 200, nstart = 50)
coasters.k2  

coasters.k3 <- kmeans(coasters_scaled, centers=3, iter.max = 200, nstart = 50)
coasters.k3  #46.9%

coasters.k4 <- kmeans(coasters_scaled, centers=4, iter.max = 200, nstart = 50)
coasters.k4  #56.1

coasters.k5 <- kmeans(coasters_scaled, centers=5, iter.max = 200, nstart = 50)
coasters.k5  #65.3%

coasters.k6 <- kmeans(coasters_scaled, centers=6, iter.max = 200, nstart = 50)
coasters.k6  #70.9%

coasters.k7 <- kmeans(coasters_scaled, centers=7, iter.max = 200, nstart = 50)
coasters.k7  #75.1%

clusplot(coasters_scaled, coasters.k2$cluster, color=TRUE, shade=TRUE, lines=0)
clusplot(coasters_scaled, coasters.k3$cluster, color=TRUE, shade=TRUE, lines=0)
clusplot(coasters_scaled, coasters.k4$cluster, color=TRUE, shade=TRUE, lines=0)
clusplot(coasters_scaled, coasters.k5$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)
clusplot(coasters_scaled, coasters.k6$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)
clusplot(coasters_scaled, coasters.k7$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)

plotcluster(coasters_scaled, coasters.k7$cluster)
```

```{r}

```

